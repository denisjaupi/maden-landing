document.getElementById('year').textContent = new Date().getFullYear();

const icons = {
spotify: `<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 1.5C6.2 1.5 1.5 6.2 1.5 12S6.2 22.5 12 22.5 22.5 17.8 22.5 12 17.8 1.5 12 1.5zm4.99 15.2a.84.84 0 0 1-1.16.28c-3.18-1.94-7.19-2.38-11.9-1.3a.84.84 0 0 1-.39-1.64c5.1-1.2 9.54-.7 13.02 1.38.35.21.46.67.23 1.28zm1.66-3.17a1.05 1.05 0 0 1-1.45.35c-3.64-2.22-9.18-2.87-13.49-1.56a1.05 1.05 0 1 1-.61-2.02c4.86-1.46 11-.73 15.15 1.8.5.3.66.96.4 1.44zm.15-3.33c-4.34-2.58-11.53-2.81-15.66-1.53a1.27 1.27 0 1 1-.73-2.43c4.78-1.44 12.74-1.15 17.74 1.79a1.27 1.27 0 0 1-1.35 2.17z"/></svg>`,
applemusic: `<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M16.36 2c-.77.05-1.69.45-2.23.98-.49.48-.93 1.26-1.03 1.96-.01.07-.02.14-.03.15-.41-.08-1.03-.06-1.45.04-1.04.23-1.95.89-2.53 1.82-.32.51-.51 1.08-.57 1.72-.03.37-.02.62.06.96.1.42.25.77.53 1.18.08.12.15.22.15.22s-.07.11-.16.22c-.36.46-.62 1.03-.73 1.53-.08.36-.08.98 0 1.33.25 1.08.97 1.97 1.97 2.39.44.19.8.25 1.31.25.93-.01 1.71-.33 2.4-.98.23-.22.38-.4.58-.71.24-.38.4-.76.47-1.19.03-.18.04-.52.01-.7-.15-.99-.8-1.87-1.68-2.25-.46-.2-1.02-.27-1.54-.18.21-.71.7-1.34 1.34-1.74.76-.48 1.65-.61 2.49-.38.06.02.12.03.18.04.06-.3.23-.87.35-1.15.42-.99 1.14-1.62 2.07-1.79.22-.04.65-.03.86.02.84.21 1.49.95 1.65 1.89.04.2.03.6-.01.81-.21 1.03-1 1.79-2.03 1.93-.32.04-.72.02-1-.06l.01.1c.04.88-.48 1.75-1.29 2.18-.39.2-.75.29-1.2.28-.5-.01-.89-.13-1.29-.41-.1-.07-.17-.12-.18-.11.02.11.04.22.04.37 0 .35-.03.52-.11.79-.21.63-.61 1.16-1.15 1.53-.69.47-1.59.61-2.4.39-.54-.15-1.05-.47-1.4-.89-.1-.12-.24-.35-.24-.38 0-.01.04-.04.08-.07.26-.17.59-.49.78-.75.49-.67.67-1.55.48-2.34.41.24.87.36 1.36.37.83.01 1.55-.3 2.13-.92.46-.49.71-1.05.78-1.73-.05-.88-.67-1.67-1.5-2.23-.62-.44-1.39-.61-2.14-.47.25-.9.85-1.65 1.66-2.07.68-.36 1.51-.44 2.26-.21.65.2 1.24.64 1.62 1.22.2.31.34.65.42 1.04.05.26.07.71.04.98-.13.98-.67 1.84-1.5 2.37-.39.25-.79.41-1.29.49-.21.04-.77.04-.98 0-.83-.14-1.56-.51-2.12-1.1-.52-.55-.83-1.24-.92-2-.02-.18-.02-.5 0-.67.05-.39.16-.76.33-1.1.5-1 1.37-1.71 2.43-2.01.41-.11 1.03-.16 1.46-.11.46.05.95.21 1.33.43 0-1.31.87-2.52 2.08-3 .23-.09.53-.17.78-.21.2-.03.66-.04.85-.02z"/></svg>`,
youtube: `<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M23.5 6.2a3 3 0 0 0-2.1-2.1C19.4 3.5 12 3.5 12 3.5s-7.4 0-9.4.6A3 3 0 0 0 .5 6.2 31 31 0 0 0 0 12a31 31 0 0 0 .5 5.8 3 3 0 0 0 2.1 2.1c1.9.6 9.3.6 9.3.6s7.4 0 9.4-.6a3 3 0 0 0 2.1-2.1c.4-1.9.5-3.8.5-5.8s-.1-3.9-.5-5.8zM9.8 15.6V8.4L15.8 12 9.8 15.6z"/></svg>`
};

document.querySelectorAll('[data-platform]').forEach(btn => {
const platform = btn.getAttribute('data-platform');
const icon = btn.querySelector('.btn-icon');
if (icons[platform] && icon) icon.innerHTML = icons[platform];
});

// Audio preview
const audio = document.getElementById('preview');
const toggle = document.getElementById('playToggle');
const MAX_SECONDS = 30;
let stopTimer = null;

function stopPreview() {
audio.pause();
audio.currentTime = 0;
toggle.textContent = '▶︎ Riproduci preview';
if (stopTimer) clearInterval(stopTimer);
}

toggle.addEventListener('click', () => {
if (audio.paused) {
audio.play();
toggle.textContent = '❚❚ Pausa';
stopTimer = setInterval(() => {
if (audio.currentTime >= MAX_SECONDS) stopPreview();
}, 250);
} else {
stopPreview();
}
});

audio.addEventListener('ended', stopPreview);
